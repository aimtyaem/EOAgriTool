<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Keep existing head content -->
    <style>
        /* Add updated CSS to match dashboard styling */
        :root {
            --primary: #2c5f2d;
            --secondary: #97bc62;
            --background: #f4faf4;
            --card-bg: #ffffff;
        }

        .field-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            transition: transform 0.2s ease;
        }

        .field-card:hover {
            transform: translateY(-3px);
        }

        .data-row {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 8px;
            background: #f8f8f8;
            border-radius: 6px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 10px;
        }
    .preview-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 10px;
    margin-top: 15px;
}

.media-item {
    position: relative;
    border-radius: 8px;
    overflow: hidden;
}

.media-item img, .media-item video {
    width: 100%;
    height: 100px;
    object-fit: cover;
}

.media-meta {
    padding: 4px 8px;
    background: rgba(0,0,0,0.7);
    color: white;
    display: flex;
    justify-content: space-between;
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    font-size: 0.8em;
}
    </style>
</head>
<body>
    <div class="container">
        <!-- Updated field cards to match dashboard style -->
        <div class="fields-grid">
            <div class="field-card">
                <div class="health-indicator good"></div>
                <div class="field-header">
                    <div class="field-icon">ðŸŒ¾</div>
                    <div>
                        <h3>Field 1</h3>
                        <div class="data-row">
                            <span>Crop Type</span>
                            <span>Wheat</span>
                        </div>
                    </div>
                </div>
                <div class="data-row">
                    <div>
                        <span class="status-indicator good"></span>
                        Health Status
                    </div>
                    <span>Good</span>
                </div>
                <div class="data-row">
                    <span>Yield</span>
                    <span>8.0 t/ha</span>
                </div>
                <div class="data-row">
                    <span>Last Updated</span>
                    <span>2h ago</span>
                </div>
            </div>
            <!-- Repeat for other fields -->
        </div>

        <!-- Updated media upload section -->
        <div class="upload-section">
            <h3>ðŸ“¤ Upload Field Documentation</h3>
            <input type="file" id="mediaUpload" accept="image/*,video/*" multiple>
            <p>Drag files here or click to upload</p>
            <div id="mediaPreview" class="preview-grid"></div>
        </div>

        <!-- Enhanced navigation button -->
        <button class="nav-button" id="dashboardBtn">
            ðŸ“Š View Dashboard
        </button>
    </div>

    <script>
        // Enhanced field data structure
        let fieldData = {
            fields: [
                {
                    id: 1,
                    name: "Field 1",
                    crop: "Wheat",
                    health: "good",
                    yield: "8.0 t/ha",
                    lastUpdated: new Date().toISOString(),
                    media: []
                }
            ]
        };

        // Improved media upload handler
        document.getElementById('mediaUpload').addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            const mediaPreview = document.getElementById('mediaPreview');
            
            files.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const mediaItem = document.createElement('div');
                    mediaItem.className = 'media-item';
                    mediaItem.innerHTML = `
                        ${file.type.startsWith('image') ? 
                            `<img src="${e.target.result}" alt="Field documentation ${index + 1}">` :
                            `<video controls src="${e.target.result}"></video>`
                        }
                        <div class="media-meta">
                            <span>${new Date().toLocaleDateString()}</span>
                            <span>${file.type.split('/')[0]}</span>
                        </div>
                    `;
                    
                    mediaPreview.appendChild(mediaItem);
                    fieldData.fields[0].media.push({
                        type: file.type.split('/')[0],
                        url: e.target.result,
                        timestamp: new Date().toISOString()
                    });
                    
                    // Update last modified time
                    fieldData.fields[0].lastUpdated = new Date().toISOString();
                    refreshFieldCards();
                };
                reader.readAsDataURL(file);
            });
        });

        // Refresh field cards display
        function refreshFieldCards() {
            const fieldCards = document.querySelectorAll('.field-card');
            fieldCards.forEach((card, index) => {
                const field = fieldData.fields[index];
                card.querySelector('.health-indicator').className = 
                    `health-indicator ${field.health}`;
                card.querySelector('[data-field="yield"]').textContent = 
                    field.yield;
                card.querySelector('[data-field="lastUpdated"]').textContent = 
                    `${timeSince(new Date(field.lastUpdated))} ago`;
            });
        }

        // Time formatting helper
        function timeSince(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
            const intervals = {
                year: 31536000,
                month: 2592000,
                day: 86400,
                hour: 3600,
                minute: 60
            };
            
            for (const [unit, secondsInUnit] of Object.entries(intervals)) {
                const interval = Math.floor(seconds / secondsInUnit);
                if (interval >= 1) {
                    return `${interval} ${unit}${interval !== 1 ? 's' : ''}`;
                }
            }
            return `${Math.floor(seconds)} seconds`;
        }

        // Initialize on load
        window.addEventListener('load', () => {
            try {
                const savedData = localStorage.getItem('fieldData');
                if(savedData) {
                    fieldData = JSON.parse(savedData);
                    refreshFieldCards();
                }
            } catch (error) {
                console.error('Error loading field data:', error);
                localStorage.setItem('fieldData', JSON.stringify(fieldData));
            }
        });
    </script>
<script>    // Navigation functionality with data save
    document.getElementById('dashboardBtn').addEventListener('click', () => {
        saveClimateData();
        window.location.href = 'dashboard.html';
    });
</script>
</body>
</html>